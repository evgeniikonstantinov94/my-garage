---
import Item from '../../components/Item.astro';
import ItemList from '../../components/ItemList.astro';
import Layout from '../../layouts/Layout.astro';


export async function getStaticPaths() {
  const allPosts = Object.values(import.meta.glob('../cars/*.md', { eager: true }));

  const uniqueTags = [...new Set(allPosts.map((post: any) => post.frontmatter.brand).flat())];

  return uniqueTags.map((brand) => {
    const filteredPosts = allPosts.filter((car: any) => car.frontmatter.brand.includes(brand));

      return {
        params: { brand },
        props: { cars: filteredPosts },
      };
  });


}

const { brand } = Astro.params;
const { cars } = Astro.props;
---
<Layout pageTitle={brand}>
  <ul>
    <ItemList items={cars}>
  </ul>
</Layout>